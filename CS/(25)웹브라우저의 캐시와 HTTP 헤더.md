# 웹브라우저의 캐시와 HTTP 헤더

### 로컬스토리지란?

- 로컬스토리지는 웹 스토리지 객체로 브라우저 내에 키-밸류 형태로 오리진에 종속되어 저장되는 데이터를 말한다.
- 하나의 키에 하나의 값만 저장된다.
- 데이터는 브라우저에서 수동으로 삭제하지 않는 한 로컬저장소에 저장되며 만료 날짜가 없다.
- 사용자가 탭을 닫거나, 컴퓨터를 종료해도 만료되지 않는다.
- 최대 저장용량은 5MB이다.
- 사용자의 행위기억, 로그인 유지하기 위한 값으로 사용되며 자동으로 서버로 전송되지 않는다.

### 로컬스토리지와 오리진

![image](https://user-images.githubusercontent.com/76714485/232525784-12bed3ab-662f-43af-95d8-b245321fd916.png)

- 로컬스토리지는 브라우저 내에 오리진에 종속되어 저장되는 데이터이다.
- 오리진이 같은 브라우저 내에서 공유된다.

### 세션스토리지란?

- 세션스토리지란 웹 스토리지 객체로 브라우저 내에 키-밸류 형태로 오리진에 종속되어 저장되는 데이터이다.
- 하나의 키에 하나의 값만 저장된다.
- 최대 저장용량은 5MB이다.
- 사용자가 브라우저에서 탭을 닫으면 데이터는 만료됩니다.

### HTTP헤더란?

- HTTP 바디에는 본문인 컨텐츠 본문인 JSON, html, image 등이 담긴다.
- 헤더는 바디를 설명하는 정보를 포함해서 여러가지 정보가 담긴 정보묶음이다.
- 헤더는 콜론(:)으로 구분되는 키-밸류 형태로 설정된다.
- HTTP요청을할때 일반헤더, 요청헤더, 응답헤더가 자동으로 생긴다.
- 서버에서 설정하는 헤더를 응답헤더라고 한다.
- 클라이언트에서 설정하는 헤더를 요청헤더라고 한다.

### 일반헤더

![image](https://user-images.githubusercontent.com/76714485/232525837-e8a55c0f-511a-4099-a21f-3c1ca3279088.png)

- 일반 헤더에는 요청한 URL
- 요청 메서드
- 출처 URL을 노출시킬지 말지 정하는 보안정도의 Referrer Policy 등이 있다.

### 요청헤더

![image](https://user-images.githubusercontent.com/76714485/232525885-bd1d8f99-73ac-4032-845e-0c380283fc6e.png)

- 요청 헤더는 클라이언트가 서버에 요청할떄 클라이언트가 설정하는 헤더를 말하낟.
- 요청 헤더에는 메서드, 클라이언트OS, 브라우저 정보 등이 담긴다.

### 응답 헤더

![image](https://user-images.githubusercontent.com/76714485/232525984-ac13e439-a674-499d-bb51-47ddc46bede4.png)

- 응답 헤더는 서버가 클라이언트에게 응답을 보낼때 설정하는 헤더를 말한다.
- 응답 헤더는 서버의 소프트웨어 정보 등이 담긴다.
- 일반적으로는 보안을 위해 정보를 숨긴다.

### 쿠키란?

- 쿠키는 브라우저에서 저장된 데이터 조각이다.
- 클라이언트, 서버 둘다 설정가능하지만 주로 서버에서 먼저 설정한다.
- 서버에서 응답 헤더로 Set-Cookie로 설정해서 보내면
- 클라이언트에서 요청 헤더 Cookie에 설정되어 자동을 서버에 전달한다.
- 쿠키는 서버에서 만료기한을 설정하고 저장용량은 4kb까지 가능하다.

### 쿠키의 시큐어코딩

- cookie에 세션ID를 담을 때 이 세션 ID기반으로 개인정보 유추할 수 없게 해야한다.
- 자바스크립트로 파악불가능하게 http only 옵션이 필요하다.
- 일정시간의 세션 타임아웃 걸어야 한다.

### 로컬스토리지, 세션스토리지, 쿠키의 공통점

- 브라우저에 캐싱을 함으로써 서버에 대한 요청을 줄여 서버부하를 방지할 수 있다.
- 캐싱으로 인해 다운로드 하는 컨텐츠가 줄어들어 웹사이트의 컨텐츠를 더 빨리 다운로드 가능하다.
- 사이트 기본 설정 커스터마이징을 저장하거나 로그인 상태를 유지할 때 사용될 수 있다.

### 로컬스토리지, 세션스토리지, 쿠키의 차이점

- 최대 저장 용량
    - 쿠키 : 4KB
    - 로컬 스토리지 : 5MB
    - 세션 스토리지 : 5MB
- 브라우저 허용
    - 쿠키 : HTML4 +5
    - 로컬 스토리지 : HTML5
    - 세션 스토리지 : HTML5
- 접근 범위
    - 쿠키 : 창
    - 로컬 스토리지 : 창
    - 세션 스토리지 : 탭
- 만료 기한
    - 쿠키 : 수동으로 설정
    - 로컬 스토리지 : 영구적
    - 세션 스토리지 : 탭 닫으면 소멸
- 요청과 함께 서버에 자동전송 유무
    - 쿠키 : O
    - 로컬 스토리지 : X
    - 세션 스토리지 : X
